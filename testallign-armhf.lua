--[[
local lib=require"rtnl/lib"

local function align(offset)
	 return ((offset-1+3)&(-1-3))+1
end
for i=1,20 do print(i,lib.align(i)) end
print(lib.align(33+17))
]]
data=[[
20 05 00 00 10 00 00 00 00 00 00 00 00 00 00 00 00 00 fe ff 0f 00 00 00 90 00 00 00 ff ff ff ff 08 00 03 00 77 67 32 00 08 00 0d 00 e8 03 00 00 05 00 10 00 02 00 00 00 05 00 11 00 00 00 00 00 08 00 04 00 8c 05 00 00 08 00 32 00 00 00 00 00 08 00 33 00 a0 ff ff 7f 08 00 1b 00 00 00 00 00 08 00 1e 00 00 00 00 00 08 00 1f 00 01 00 00 00 08 00 28 00 ff ff 00 00 08 00 29 00 00 00 01 00 08 00 20 00 01 00 00 00 05 00 21 00 01 00 00 00 09 00 06 00 6e 6f 6f 70 00 00 00 00 08 00 23 00 00 00 00 00 05 00 27 00 00 00 00 00 08 00 2f 00 00 00 00 00 08 00 30 00 00 00 00 00 24 00 0e 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c4 00 17 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 64 00 07 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0c 00 2b 00 05 00 02 00 00 00 00 00 14 00 12 00 0e 00 01 00 77 69 72 65 67 75 61 72 64 00 00 00 f8 02 1a 00 88 00 02 00 84 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 27 00 00 e8 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 6c 02 0a 00 08 00 01 00 00 00 00 00 14 00 05 00 ff ff 00 00 2e 26 81 00 e4 3c 00 00 e8 03 00 00 d0 00 02 00 00 00 00 00 40 00 00 00 8c 05 00 00 01 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 ff ff ff ff a0 0f 00 00 e8 03 00 00 ff ff ff ff 80 3a 09 00 80 51 01 00 03 00 00 00 58 02 00 00 10 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 60 ea 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 10 27 00 00 e8 03 00 00 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 ee 36 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2c 01 03 00 25 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 34 00 06 00 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 14 00 07 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05 00 08 00 00 00 00 00
]]

local I=require"inspect"
local function makeblobfromdata(d)
	local r=''
	for v in d:gmatch("[0-9a-fA-F]+") do
		v=tonumber(v,16)
		-- print(v)
		r=r..string.char(v)
	end
	return r
end
local message= makeblobfromdata(data)
--print(inspect.inspect(message))

local N = require "rtnetlink"
local offset=1
r,offset=N:parsemessage(message,offset)
print(offset,message:len())
print(I.inspect(r))
